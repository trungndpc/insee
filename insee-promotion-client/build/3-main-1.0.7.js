(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{133:function(t){t.exports=JSON.parse('{"1":{"name":"Nhà ở"},"2":{"name":"Khu dân cư"},"3":{"name":"Chung cư, nhà trọ"},"4":{"name":"Siêu thị, trung tâm thương mại"},"5":{"name":"Nhà thờ, đền chùa"},"6":{"name":"Nhà máy, xí nghiệp"},"7":{"name":"Công trình nhà nước"}}')},192:function(t,e,n){"use strict";n.r(e);var i=n(27),r=n.n(i),a=n(4),s=n.n(a),o=n(93),c=n.n(o),u=n(2),l=n.n(u),h=n(3),d=n.n(h),f=n(12),p=n.n(f),m=n(6),y=n.n(m),g=n(7),v=n.n(g),V=n(5),w=n.n(V),k=n(0),C=n.n(k),S=n(15),E=n(11),N=n(10),R=n(17),b=n(21),x=n(94);function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var T=function(t){y()(i,t);var e,n=(e=i,function(){var t,n=w()(e);if(P()){var i=w()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return v()(this,t)});function i(t){var e;return l()(this,i),(e=n.call(this,t)).state={ownerName:"",ownerPhone:""},e.getValues=e.getValues.bind(p()(e)),e}return d()(i,[{key:"shouldComponentUpdate",value:function(t,e){return""==e.ownerName||""==e.ownerPhone?(t.ownerName&&t.ownerName!=e.ownerName&&(e.ownerName=t.ownerName),t.ownerPhone&&t.ownerPhone!=e.ownerPhone&&(e.ownerPhone=t.ownerPhone),!0):this.state!=e}},{key:"getValues",value:function(){return{name:this.nameInputRef.value,phone:this.phoneInputRef.value}}},{key:"render",value:function(){var t=this;return C.a.createElement("div",{className:"owner-input"},C.a.createElement("div",{style:{float:"left"},className:"owner-input-name"},C.a.createElement("input",{value:this.state.ownerName,onChange:function(e){return t.setState({ownerName:e.target.value})},ref:function(e){return t.nameInputRef=e},className:"insee-input",type:"text",placeholder:"Tên chủ nhà"})),C.a.createElement("div",{style:{float:"right"},className:"owner-input-phone"},C.a.createElement("input",{value:this.state.ownerPhone,onChange:function(e){return t.setState({ownerPhone:e.target.value})},ref:function(e){return t.phoneInputRef=e},className:"insee-input",type:"text",placeholder:"SDT"})))}}]),i}(k.Component),I=n(133),_=[];for(var D in I){var O={key:D,value:I[D].name};_.push(O)}var M=function(){function t(){l()(this,t)}return d()(t,null,[{key:"getList",value:function(){return _}}]),t}(),A=n(106),q=n.n(A),L=(n(134),n(185));function U(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}Object(A.registerLocale)("vi",L.a);var j=function(t){y()(i,t);var e,n=(e=i,function(){var t,n=w()(e);if(U()){var i=w()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return v()(this,t)});function i(t){var e;return l()(this,i),(e=n.call(this,t)).state={date:null},e.handleChange=e.handleChange.bind(p()(e)),e.getValue=e.getValue.bind(p()(e)),e}return d()(i,[{key:"shouldComponentUpdate",value:function(t,e){return t.date&&t.date!=e.date&&null==e.date?(e.date=t.date,!0):this.state!=e}},{key:"getValue",value:function(){var t=this.state.date;if(t){var e=t.getMonth()+1,n=t.getFullYear();return new Date(n,e,0,0,0,0,0).getTime()/1e3}}},{key:"handleChange",value:function(t){this.setState({date:t})}},{key:"render",value:function(){return C.a.createElement(q.a,{placeholderText:"Thời gian dự kiến thi công (tháng/năm)",selected:this.state.date,showMonthYearPicker:!0,onChange:this.handleChange,dateFormat:"MMMM - yyyy",className:"insee-input",locale:"vi"})}}]),i}(k.Component),F=n(87),Q=n(95),J=n(86),B=n(37),H=(n(96),n(35));function Y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var K=function(t){y()(a,t);var e,n,i,r=(e=a,function(){var t,n=w()(e);if(Y()){var i=w()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return v()(this,t)});function a(t){var e;return l()(this,a),(e=r.call(this,t)).state={errorMsg:null,address:"",city:0,district:0,ownerName:"",ownerPhone:"",typeConstruction:0,estimateTimeStart:0,agreeValue:2},e.noteRequirRef=C.a.createRef(),e._getConstruction=e._getConstruction.bind(p()(e)),e._getForm=e._getForm.bind(p()(e)),e._addOrUpdate=e._addOrUpdate.bind(p()(e)),e._submit=e._submit.bind(p()(e)),e._update=e._update.bind(p()(e)),e}return d()(a,[{key:"componentDidMount",value:function(){this._getConstruction()}},{key:"_getConstruction",value:function(){var t=this;this.props.constructionId&&B.a.get(this.props.constructionId).then((function(e){if(e.error==H.a.SUCCESS){var n=e.data;console.log(n),t.setState({construction:n,address:n.address,city:n.city,district:n.district,ownerName:n.name,ownerPhone:n.phone,typeConstruction:n.typeConstruction,estimateTimeStart:n.estimateTimeStart,agreeValue:extra.agree[0]}),console.log(t.state)}})).catch((function(t){}))}},{key:"_getForm",value:function(){var t=this.addressInputRef.value,e=this.locationInputRef.getValues(),n=this.dateInputRef.getValue(),i=this.typeProjectInputRef.value,r=this.ownerInputRef.getValues();return{address:t,city:e.city,district:e.district,estimateTimeStart:n,typeConstruction:i,name:r.name,phone:r.phone,extra:{agree:[parseInt(this.noteRequirRef.current.value)]},promotionId:parseInt(this.props.promotionId),type:Q.a.getType()}}},{key:"_addOrUpdate",value:function(t){var e=this;B.a.addOrUpdate(t).then((function(t){if(console.log(t),t.error==H.a.SUCCESS){var n=t.data.id;window.pushHistory("/khuyen-mai/cong-trinh-tiep-theo/".concat(n))}else e.setState({errorMsg:""})})).catch((function(t){e.setState({errorMsg:""})}))}},{key:"_submit",value:(i=c()(s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.setState({errorMsg:""});case 3:this.props.appActions.setStatusLoading(!0),e=this._getForm(),J.a.isValid2Create(e)&&this._addOrUpdate(e),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),this.setState({errorMsg:t.t0}),this.props.appActions.setStatusLoading(!1);case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return i.apply(this,arguments)})},{key:"_update",value:(n=c()(s.a.mark((function t(){var e,n,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.setState({errorMsg:""});case 3:if(this.props.appActions.setStatusLoading(!0),e=this._getForm(),n=this.props.app.construction,i=J.a.getChangeAndValidate(e,n),0!==Object.keys(i).length){t.next=9;break}throw"Vui lòng cập nhật thông tin";case 9:i.id=n.id,this._addOrUpdate(i),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),this.setState({errorMsg:t.t0}),this.props.appActions.setStatusLoading(!1);case 17:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var t=this;return console.log("xxxxxxxxxxx"),console.log(this.state),C.a.createElement("div",null,C.a.createElement(b.a,this.props,C.a.createElement("span",{className:"contact100-form-title"},"Chương trình giới thiệu công trình tiếp theo của tôi",C.a.createElement("div",{className:"line-bt"})),C.a.createElement("div",{className:"form-description"},"Vui lòng nhập thông tin để hoàn tất"),C.a.createElement("div",{className:"form-row"},C.a.createElement("input",{ref:function(e){return t.addressInputRef=e},onChange:function(e){return t.setState({address:e.target?e.target.value:""})},value:this.state.address,className:"insee-input",type:"text",placeholder:"Địa chỉ công trình"})),C.a.createElement("div",{className:"form-row"},C.a.createElement(x.a,{city:this.state.city,district:this.state.district,ref:function(e){return t.locationInputRef=e}})),C.a.createElement("div",{className:"form-row"},C.a.createElement(j,{date:this.state.estimateTimeStart&&new Date(1e3*this.state.estimateTimeStart),ref:function(e){return t.dateInputRef=e}})),C.a.createElement("div",{className:"form-row"},C.a.createElement("select",{value:this.state.typeConstruction,onChange:function(e){return t.setState({typeConstruction:e.target.value})},ref:function(e){return t.typeProjectInputRef=e},className:"insee-input"},C.a.createElement("option",{value:0},"Loại hình dự án"),M.getList().map((function(t,e){return C.a.createElement("option",{key:t.key,value:t.key},t.value)})))),C.a.createElement("div",{className:"form-row"},C.a.createElement(T,{ownerName:this.state.ownerName,ownerPhone:this.state.ownerPhone,ref:function(e){return t.ownerInputRef=e}})),C.a.createElement("div",{onClick:function(){return t.setState({agreeValue:2})},className:"form-row prelative policy"},C.a.createElement("input",{ref:this.noteRequirRef,value:2,checked:2==this.state.agreeValue,onChange:function(){return t.setState({agreeValue:2})},name:"note-customer",type:"radio"}),C.a.createElement("span",null,"Tôi đồng ý cho nhân viên INSEE gọi chủ nhà để xác nhận thông tin (nhà thầu nên thông báo cho chủ nhà trước)")),C.a.createElement("div",{onClick:function(){return t.setState({agreeValue:3})},className:"form-row prelative policy"},C.a.createElement("input",{ref:this.noteRequirRef,value:3,checked:3==this.state.agreeValue,onChange:function(){return t.setState({agreeValue:3})},name:"note-customer",type:"radio"}),C.a.createElement("span",null,"Chỉ cho phép nhân viên INSEE tới kiểm tra trực tiếp tại công trình (quà tặng sẽ được gửi cho nhà thầu ngay sau khí xác nhận trực tiếp)")),this.state.errorMsg&&C.a.createElement("div",{className:"msg-error"},C.a.createElement("span",null,"*** ",this.state.errorMsg)),C.a.createElement("div",{className:"btn-container"},this.props.app.construction?C.a.createElement("button",{onClick:this._update,className:"btn-insee btn-insee-bg"},"Cập nhật"):C.a.createElement("button",{onClick:this._submit,className:"btn-insee btn-insee-bg"},"Xác nhận"))),C.a.createElement(F.a,this.props))}}]),a}(C.a.Component);e.default=Object(S.b)((function(t){return{app:t.app}}),(function(t){return{appActions:Object(E.b)(R,t)}}))((function(t){var e=Object(N.g)(),n=e.promotionId,i=e.constructionId;return C.a.createElement(K,r()({promotionId:n,constructionId:i},t))}))},86:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return l}));var i=n(2),r=n.n(i),a=n(3),s=n.n(a),o=/((|09|03|07|08|05)+([0-9]{8})\b)/i,c=function(){function t(){r()(this,t)}return s()(t,null,[{key:"getChangeAndValidate",value:function(t,e,n){var i={id:e.id};if(t.address!=e.address&&this.isValidAddress(t.address)&&(i.address=t.address),t.city!=e.city&&this.isValidCity(t.city)&&(i.city=t.city),t.district!=e.district&&this.isValidDistrict(t.district)&&(i.district=t.district),t.name!=e.name&&this.isValidStoreName(t.name)&&(i.name=t.name),t.phone!=e.phone&&this.isValidPhoneName(t.phone)&&(i.phone=t.phone),t.cement!=e.cement&&this.isValidCement(t.cement)&&(i.cement=t.cement),t.quantity!=e.quantity){if(!this.isValidQuantity(t.quantity,n.ruleQuantily))return null;i.quantity=t.quantity}return t.extra.agree[0]!=e.extra.agree[0]&&this.isValidPolicy(t.extra)&&(i.extra=t.extra),i}},{key:"isValid2Create",value:function(t,e){return this.isValidAddress(t.address)&&this.isValidCity(t.city)&&this.isValidDistrict(t.district)&&this.isValidStoreName(t.name)&&this.isValidPhoneName(t.phone)&&this.isValidCement(t.cement)&&this.isValidQuantity(t.quantity,e.ruleQuantily)&&this.isValidPolicy(t.extra)}},{key:"isValidAddress",value:function(t){if(!t)throw"Vui lòng nhập địa chỉ";if(t.length<=10)throw"Địa chỉ phải lớn hơn 10 ký tự";return!0}},{key:"isValidCity",value:function(t){if(0==t)throw"Vui lòng chọn thành phố";return!0}},{key:"isValidDistrict",value:function(t){if(0==t)throw"Vui lòng chọn quận";return!0}},{key:"isValidStoreName",value:function(t){if(!t)throw"Vui lòng nhập tên cửa hàng";if(t.length<=5)throw"Tên cửa hàng phải lớn hơn 5 ký tự";return!0}},{key:"isValidPhoneName",value:function(t){if(!t)throw"Vui lòng nhập số điện thoại";if(!o.test(t))throw"Số điện thoại không hợp lệ";return!0}},{key:"isValidQuantity",value:function(t,e){if(!t||0==t)throw"Vui lòng nhập số lượng sản phẩm";return!(t<e)}},{key:"isValidBill",value:function(t,e){if(!(t&&0!=t.length||e&&0!=e))throw"Vui lòng chọn ít nhất một hóa đơn";if(t&&t.length>=3)throw"Số hóa đơn nhỏ hơn 3";return!0}},{key:"isValidImg",value:function(t,e){if(!(t&&0!=t.length||e&&0!=e))throw"Vui lòng chọn ít nhất một hình ảnh";if(t&&t.length>=3)throw"Số hình ảnh nhỏ hơn 3";return!0}},{key:"isValidPolicy",value:function(t){var e=t.agree;if(!e||!e.includes(1))throw"Vui lòng đồng ý với điều khoản của chúng tôi";return!0}},{key:"isValidCement",value:function(t){if(!t||0==t)throw"Vui lòng nhập loại xi măng";return!0}}]),t}(),u=function(){function t(){r()(this,t)}return s()(t,null,[{key:"getChangeAndValidate",value:function(t,e){var n={};return t.address!=e.address&&this.isValidAddress(t.address)&&(n.address=t.address),t.city!=e.city&&this.isValidCity(t.city)&&(n.city=t.city),t.district!=e.district&&this.isValidDistrict(t.district)&&(n.district=t.district),t.name!=e.name&&this.isValidOwnerName(t.name)&&(n.name=t.name),t.phone!=e.phone&&this.isValidOwnerPhone(t.phone)&&(n.phone=t.phone),t.estimateTimeStart!=e.estimateTimeStart&&this.isValidEstimateTimeStart(t.estimateTimeStart)&&(n.estimateTimeStart=t.estimateTimeStart),t.typeConstruction!=e.typeConstruction&&this.isValidTypeConstruction(t.typeConstruction)&&(n.typeConstruction=t.typeConstruction),t.extra.agree[0]!=e.extra.agree[0]&&(n.extra=t.extra),n}},{key:"isValid2Create",value:function(t){return this.isValidAddress(t.address)&&this.isValidCity(t.city)&&this.isValidDistrict(t.district)&&this.isValidEstimateTimeStart(t.estimateTimeStart)&&this.isValidEstimateTimeStart(t.typeConstruction)&&this.isValidOwnerName(t.name)&&this.isValidOwnerPhone(t.phone)}},{key:"isValidAddress",value:function(t){if(!t)throw"Vui lòng nhập địa chỉ";if(t.length<=10)throw"Địa chỉ phải lớn hơn 10 ký tự";return!0}},{key:"isValidCity",value:function(t){if(0==t)throw"Vui lòng chọn thành phố";return!0}},{key:"isValidDistrict",value:function(t){if(0==t)throw"Vui lòng chọn quận";return!0}},{key:"isValidEstimateTimeStart",value:function(t){if(!t)throw"Vui lòng chọn thời gian công trình bắt đầu";return!0}},{key:"isValidTypeConstruction",value:function(t){if(!t||0==t)throw"Vui lòng chọn loại công trình";return!0}},{key:"isValidOwnerName",value:function(t){if(!t)throw"Vui lòng nhập tên chủ nhà";if(t.length<=3)throw"Tên chủ nhà lớn hơn 3 ký tự";return!0}},{key:"isValidOwnerPhone",value:function(t){if(!t)throw"Vui lòng nhập số điện thoại chủ nhà";if(!o.test(t))throw"Số điện thoại không hợp lệ";return!0}}]),t}(),l=function(){function t(){r()(this,t)}return s()(t,null,[{key:"isValid2Create",value:function(t){return this.isValidName(t.name)&&this.isValidArea(t.location)}},{key:"isValidPhone",value:function(t){if(!t)throw"Vui lòng nhập số điện thoại";if(t=t.replace(/\./g,""),!o.test(t))throw"Số điện thoại không hợp lệ";return!0}},{key:"isValidName",value:function(t){if(!t)throw"Vui lòng nhập họ và tên của bạn";if(t.length<=5)throw"Họ và tên phải lớn hơn 5 ký tự";return!0}},{key:"isValidBirthday",value:function(t){if(0!=t.error)throw t.errorMsg;return!0}},{key:"isValidArea",value:function(t){if(0==t)throw"Vui lòng nhập khu vực chính";return!0}}]),t}()},87:function(t,e,n){"use strict";var i=n(2),r=n.n(i),a=n(3),s=n.n(a),o=n(6),c=n.n(o),u=n(7),l=n.n(u),h=n(5),d=n.n(h),f=n(0),p=n.n(f);function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var y=function(t){c()(a,t);var e,i=(e=a,function(){var t,n=d()(e);if(m()){var i=d()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return l()(this,t)});function a(t){return r()(this,a),i.call(this,t)}return s()(a,[{key:"shouldComponentUpdate",value:function(t,e){return this.props.app.isLoading!=t.app.isLoading}},{key:"render",value:function(){return this.props.app.isLoading?(document.body.scrollTop=0,document.documentElement.scrollTop=0,p.a.createElement("div",{className:"insee-app"},p.a.createElement("div",{className:"bg-loading"}),p.a.createElement("img",{className:"img-loading",src:n(48)}))):p.a.createElement("div",null)}}]),a}(f.Component);e.a=y},94:function(t,e,n){"use strict";var i=n(2),r=n.n(i),a=n(3),s=n.n(a),o=n(12),c=n.n(o),u=n(6),l=n.n(u),h=n(7),d=n.n(h),f=n(5),p=n.n(f),m=n(0),y=n.n(m),g=n(22);function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var V=g.a.getList(),w=function(t){l()(i,t);var e,n=(e=i,function(){var t,n=p()(e);if(v()){var i=p()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return d()(this,t)});function i(t){var e;return r()(this,i),(e=n.call(this,t)).state={city:0,district:0},e.getValues=e.getValues.bind(c()(e)),e}return s()(i,[{key:"shouldComponentUpdate",value:function(t,e){return 0==this.state.city||0==this.state.district?(0!=t.city&&t.city!=this.state.city&&(e.city=t.city),0!=t.district&&t.district!=this.state.district&&(e.district=t.district),!0):this.state!=e}},{key:"getValues",value:function(){return{city:this.cityInputRef.value,district:this.districtInputRef.value}}},{key:"render",value:function(){var t=this,e=g.b.getList(this.state.city);return y.a.createElement("div",{className:"location-input"},y.a.createElement("div",{style:{float:"left"},className:"location-input-city"},y.a.createElement("select",{value:this.state.city,onChange:function(e){return t.setState({city:e.target.value})},ref:function(e){return t.cityInputRef=e}},y.a.createElement("option",{value:0},"Tỉnh"),V&&V.map((function(t,e){return y.a.createElement("option",{key:e,value:t.key},t.value)})))),y.a.createElement("div",{style:{float:"right"},className:"location-input-district"},y.a.createElement("select",{value:this.state.district,onChange:function(e){return t.setState({district:e.target.value})},ref:function(e){return t.districtInputRef=e}},y.a.createElement("option",{value:0},"Quận"),e&&e.map((function(t,e){return y.a.createElement("option",{key:e,value:t.key},t.value)})))))}}]),i}(m.Component);e.a=w},95:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var i=n(2),r=n.n(i),a=n(3),s=n.n(a),o=function(){function t(e){r()(this,t),this.type=e}return s()(t,[{key:"getType",value:function(){return this.type}}],[{key:"findByType",value:function(t){switch(t){case 1:return c;case 2:return u;default:return null}}}]),t}(),c=new o(1),u=new o(2)},96:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(2),r=n.n(i),a=n(3),s=n.n(a),o=n(9),c=function(){function t(){r()(this,t)}return s()(t,null,[{key:"get",value:function(t){return new Promise((function(e,n){o.a.getJSONWithCredentials("https://nhathau.insee.com.vn/api/admin/post?id="+t,e,n)}))}}]),t}()}}]);